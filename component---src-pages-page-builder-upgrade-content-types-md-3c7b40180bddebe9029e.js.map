{"version":3,"file":"component---src-pages-page-builder-upgrade-content-types-md-3c7b40180bddebe9029e.js","mappings":"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","sources":["webpack://commerce-frontend-core/./src/pages/page-builder/upgrade-content-types.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/commerce-frontend-core/commerce-frontend-core/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"upgrade-content-types\"\n    }}>{`Upgrade content types`}</h1>\n    <p>{`Before version 1.3, if we updated our content-type configurations and sent them out with a new version of Page Builder, it could break the data you saved using the previous version. This happened because the configuration data of a content type is mapped to the content type's display templates. So when we change a configuration, the display of existing content might also change. With significant changes, the data from the appearance `}<inlineCode parentName=\"p\">{`element`}</inlineCode>{` nodes (`}<inlineCode parentName=\"p\">{`attributes`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`css`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`html`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`style`}</inlineCode>{`, and `}<inlineCode parentName=\"p\">{`tag`}</inlineCode>{`) is lost. Such changes cause existing content to appear incorrectly, or not at all.`}</p>\n    <p>{`To fix this limitation, Page Builder now uses Adobe Commerces's native upgrade mechanism, coupled with our content upgrade helpers. These helpers convert existing content so that it maps to new configurations and displays correctly.`}</p>\n    <h2 {...{\n      \"id\": \"example-updating-the-row-content-type\"\n    }}>{`Example: Updating the Row content type`}</h2>\n    <p>{`Let's imagine that the Page Builder team needs to change the configuration of the Row's full-width appearance to fix a layout issue. The fix is simple. We need to move a style attribute from one element in the Row's full-width appearance to another element. But without the upgrade helpers, our change to the Row's configuration would break all previously saved Page Builder content that uses Rows.`}</p>\n    <p>{`To fix this issue, we created a set of Page Builder DOM helper classes (`}<inlineCode parentName=\"p\">{`Magento\\\\PageBuilder\\\\Model\\\\Dom\\\\*`}</inlineCode>{`) that we can use to update all our native content types (including the Row) that have already been stored in the database.`}</p>\n    <h2 {...{\n      \"id\": \"steps-overview\"\n    }}>{`Steps overview`}</h2>\n    <p>{`There are three steps to upgrading a content type when changing its configuration:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Create a Converter (Example: `}<inlineCode parentName=\"p\">{`FixFullWidthRowPadding.php`}</inlineCode>{`)`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Create a Data Patch (Example: `}<inlineCode parentName=\"p\">{`UpgradeFullWidthPadding.php`}</inlineCode>{`)`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Update the UpgradableEntitiesPool (for custom entities)(`}<inlineCode parentName=\"p\">{`Magento\\\\PageBuilder\\\\Model\\\\UpgradableEntitiesPool`}</inlineCode>{`)`}</p>\n      </li>\n    </ol>\n    <p>{`For our Row example, the Page Builder team would add the following files to the `}<inlineCode parentName=\"p\">{`Magento/PageBuilder/Setup`}</inlineCode>{` directories:`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"635px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"49.6875%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-frontend-core/static/b7ef296ebf1ef3bbff410758351b28ca/5530d/upgrade-framework-example-pb.webp 320w\", \"/commerce-frontend-core/static/b7ef296ebf1ef3bbff410758351b28ca/99b64/upgrade-framework-example-pb.webp 635w\"],\n            \"sizes\": \"(max-width: 635px) 100vw, 635px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-frontend-core/static/b7ef296ebf1ef3bbff410758351b28ca/dd4a7/upgrade-framework-example-pb.png 320w\", \"/commerce-frontend-core/static/b7ef296ebf1ef3bbff410758351b28ca/ee2c8/upgrade-framework-example-pb.png 635w\"],\n            \"sizes\": \"(max-width: 635px) 100vw, 635px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/commerce-frontend-core/static/b7ef296ebf1ef3bbff410758351b28ca/ee2c8/upgrade-framework-example-pb.png\",\n            \"alt\": \"Example converter and upgrader classes\",\n            \"title\": \"Example converter and upgrader classes\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <h3 {...{\n      \"id\": \"step-1-create-a-converter\"\n    }}>{`Step 1: Create a Converter`}</h3>\n    <p>{`For our Row example, the first task is to create a converter class that implements the `}<inlineCode parentName=\"p\">{`DataConverterInterface`}</inlineCode>{`. Specifically, it implements the `}<inlineCode parentName=\"p\">{`convert`}</inlineCode>{` function where it uses Page Builder's DOM helper classes to change the DOM of the Row content type within each master format it receives.`}</p>\n    <p>{`Our converter class for fixing a row padding problem might be called `}<inlineCode parentName=\"p\">{`FixFullWidthRowPadding`}</inlineCode>{`, with the following example implementation:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`<?php\n/**\n * Copyright &copy; Adobe, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndeclare(strict_types=1);\n\nnamespace Magento\\\\PageBuilder\\\\Setup\\\\Converters;\n\nuse Magento\\\\Framework\\\\DB\\\\DataConverter\\\\DataConverterInterface;\nuse Magento\\\\PageBuilder\\\\Model\\\\Dom\\\\Adapter\\\\ElementInterface;\nuse Magento\\\\PageBuilder\\\\Model\\\\Dom\\\\HtmlDocument;\nuse Magento\\\\PageBuilder\\\\Model\\\\Dom\\\\HtmlDocumentFactory;\n\n/**\n * Converter to move padding in full width columns from the main row element to the inner element\n */\nclass FixFullWidthRowPadding implements DataConverterInterface\n{\n    /**\n     * @var HtmlDocumentFactory\n     */\n    private $htmlDocumentFactory;\n\n    /**\n     * @param HtmlDocumentFactory $htmlDocumentFactory\n     */\n    public function __construct(HtmlDocumentFactory $htmlDocumentFactory)\n    {\n        $this->htmlDocumentFactory = $htmlDocumentFactory;\n    }\n\n    /**\n     * @inheritDoc\n     */\n    public function convert($value)\n    {\n        /** @var HtmlDocument $document */\n        $document = $this->htmlDocumentFactory->create([ 'document' => $value ]);\n        $fullWidthRows = $document->querySelectorAll(\"div[data-content-type='row'][data-appearance='full-width']\");\n        /** @var ElementInterface $row */\n        foreach ($fullWidthRows as $row) {\n            $style = $row->getAttribute(\"style\");\n            preg_match(\"/padding:(.*?);/\", $style, $results);\n            $padding = isset($results[1]) ? trim($results[1]) : '';\n            if (!$padding) {\n                continue;\n            }\n            // remove padding from main row element\n            $row->removeStyle(\"padding\");\n            // add padding to inner row element\n            $innerDiv = $row->querySelector(\".row-full-width-inner\");\n            $innerDiv->addStyle(\"padding\", $padding);\n        }\n        return $fullWidthRows->count() > 0 ? $document->stripHtmlWrapperTags() : $value;\n    }\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"step-2-create-a-data-patch\"\n    }}>{`Step 2: Create a Data Patch`}</h3>\n    <p>{`Our second task for updating our example Row content type is to create a Data Patch class that implements the `}<inlineCode parentName=\"p\">{`DataPatchInterface`}</inlineCode>{`. Specifically, we need to use the Page Builder `}<inlineCode parentName=\"p\">{`UpgradeContentHelper`}</inlineCode>{` class to apply the converter class to all the database entities where Page Builder content exists. These locations are provided by the `}<inlineCode parentName=\"p\">{`UpgradableEntitiesPool`}</inlineCode>{`, described later in this topic.`}</p>\n    <p>{`For our Data Patch, we'll create a class called `}<inlineCode parentName=\"p\">{`UpgradeFullWidthPadding`}</inlineCode>{`, which fixes our row padding problem with the following example implementation:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`<?php\n/**\n * Copyright &copy; Adobe, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\nnamespace Magento\\\\PageBuilder\\\\Setup\\\\Patch\\\\Data;\n\nuse Magento\\\\Framework\\\\DB\\\\FieldDataConversionException;\nuse Magento\\\\Framework\\\\Setup\\\\Patch\\\\DataPatchInterface;\nuse Magento\\\\PageBuilder\\\\Setup\\\\Converters\\\\FixFullWidthRowPadding;\nuse Magento\\\\PageBuilder\\\\Setup\\\\UpgradeContentHelper;\n\n/**\n * Patch upgrade mechanism allows us to do atomic data changes\n */\nclass UpgradeFullWidthPadding implements DataPatchInterface\n{\n    /**\n     * @var UpgradeContentHelper\n     */\n    private $helper;\n\n    /**\n     * @param UpgradeContentHelper $helper\n     */\n    public function __construct(\n        UpgradeContentHelper $helper\n    ) {\n        $this->helper = $helper;\n    }\n\n    /**\n     * Do upgrade\n     *\n     * @return void\n     * @throws FieldDataConversionException\n     */\n    public function apply()\n    {\n        $this->helper->upgrade([\n            FixFullWidthRowPadding::class\n        ]);\n    }\n\n    /**\n     * @inheritdoc\n     */\n    public function getAliases()\n    {\n        return [];\n    }\n\n    /**\n     * @inheritdoc\n     */\n    public static function getDependencies()\n    {\n        return [];\n    }\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"step-3-update-the-upgradableentitiespool-for-custom-entities\"\n    }}>{`Step 3: Update the UpgradableEntitiesPool (for custom entities)`}</h3>\n    <p>{`The `}<inlineCode parentName=\"p\">{`Magento\\\\PageBuilder\\\\Model\\\\UpgradableEntitiesPool`}</inlineCode>{` provides the locations in the database where Page Builder content exists by default. These entities include:`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`cms_block`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`cms_page`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`catalog_category_entity_text`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`catalog_product_entity_text`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`pagebuilder_template`}</inlineCode></p>\n      </li>\n    </ul>\n    <p>{`If your Magento installation does not have any additional entities for Page Builder content (beyond the defaults), you do not need to update the `}<inlineCode parentName=\"p\">{`UpgradableEntitiesPool`}</inlineCode>{`.`}</p>\n    <p>{`However, if you have created additional database entities for storing Page Builder content, you `}<em parentName=\"p\">{`must`}</em>{` add those entities to the `}<inlineCode parentName=\"p\">{`UpgradableEntitiesPool`}</inlineCode>{` type in your module's `}<inlineCode parentName=\"p\">{`etc/di.xml`}</inlineCode>{`. If you do not, the Page Builder content stored in your entity will not be updated, causing potential data-loss and display issues.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"545px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"22.812500000000004%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-frontend-core/static/165599d08ce6af4d0c961a42ace3920d/5530d/upgrade-framework-additional-entities.webp 320w\", \"/commerce-frontend-core/static/165599d08ce6af4d0c961a42ace3920d/06a3f/upgrade-framework-additional-entities.webp 545w\"],\n            \"sizes\": \"(max-width: 545px) 100vw, 545px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-frontend-core/static/165599d08ce6af4d0c961a42ace3920d/dd4a7/upgrade-framework-additional-entities.png 320w\", \"/commerce-frontend-core/static/165599d08ce6af4d0c961a42ace3920d/f2ede/upgrade-framework-additional-entities.png 545w\"],\n            \"sizes\": \"(max-width: 545px) 100vw, 545px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/commerce-frontend-core/static/165599d08ce6af4d0c961a42ace3920d/f2ede/upgrade-framework-additional-entities.png\",\n            \"alt\": \"Additional entities\",\n            \"title\": \"Additional entities\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`For example, if you have created a blog entity that stores Page Builder content, you must add your blog entity to your `}<inlineCode parentName=\"p\">{`etc/di.xml`}</inlineCode>{` file as an `}<inlineCode parentName=\"p\">{`UpgradableEntitiesPool`}</inlineCode>{` type. This entry ensures that the upgrade library can update the Page Builder content types used in your blog. An entry for our blog example might look like this:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<type name=\"Magento\\\\PageBuilder\\\\Model\\\\UpgradableEntitiesPool\">\n    <arguments>\n        <argument name=\"entities\" xsi:type=\"array\">\n            <item name=\"cms_block\" xsi:type=\"array\">\n                <item name=\"identifier\" xsi:type=\"string\">blog_id</item>\n                <item name=\"fields\" xsi:type=\"array\">\n                    <item name=\"content\" xsi:type=\"boolean\">true</item>\n                </item>\n            </item>\n        </argument>\n    </arguments>\n</type>\n`}</code></pre>\n    <p>{`In such cases, your additional entity will be merged with the default entities from `}<inlineCode parentName=\"p\">{`Magento/PageBuilder/etc/di.xml`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<type name=\"Magento\\\\PageBuilder\\\\Model\\\\UpgradableEntitiesPool\">\n    <arguments>\n        <argument name=\"entities\" xsi:type=\"array\">\n            <item name=\"cms_block\" xsi:type=\"array\">\n                <item name=\"identifier\" xsi:type=\"string\">block_id</item>\n                <item name=\"fields\" xsi:type=\"array\">\n                    <item name=\"content\" xsi:type=\"boolean\">true</item>\n                </item>\n            </item>\n            <item name=\"cms_page\" xsi:type=\"array\">\n                <item name=\"identifier\" xsi:type=\"string\">page_id</item>\n                <item name=\"fields\" xsi:type=\"array\">\n                    <item name=\"content\" xsi:type=\"boolean\">true</item>\n                </item>\n            </item>\n            <item name=\"catalog_category_entity_text\" xsi:type=\"array\">\n                <item name=\"identifier\" xsi:type=\"string\">value_id</item>\n                <item name=\"fields\" xsi:type=\"array\">\n                    <item name=\"value\" xsi:type=\"boolean\">true</item>\n                </item>\n            </item>\n            <item name=\"catalog_product_entity_text\" xsi:type=\"array\">\n                <item name=\"identifier\" xsi:type=\"string\">value_id</item>\n                <item name=\"fields\" xsi:type=\"array\">\n                    <item name=\"value\" xsi:type=\"boolean\">true</item>\n                </item>\n            </item>\n            <item name=\"pagebuilder_template\" xsi:type=\"array\">\n                <item name=\"identifier\" xsi:type=\"string\">template_id</item>\n                <item name=\"fields\" xsi:type=\"array\">\n                    <item name=\"template\" xsi:type=\"boolean\">true</item>\n                </item>\n            </item>\n        </argument>\n    </arguments>\n</type>\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"how-to-upgrade-your-custom-content-types\"\n    }}>{`How to upgrade your custom content types`}</h2>\n    <p>{`To use Page Builder's content upgrade helpers for your own content-type configuration changes, follow these steps:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Set up a new environment that uses a `}<em parentName=\"p\">{`copy`}</em>{` of your production data, far away from any real data.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Create a test branch off your local environment where you can make and test your data patch converters. You will switch back and forth off this branch to reset the data in your Commerce instance as needed.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Within the test branch for your content type module changes, set up a directory structure similar to this:`}</p>\n        <p parentName=\"li\"><span parentName=\"p\" {...{\n            \"className\": \"gatsby-resp-image-wrapper\",\n            \"style\": {\n              \"position\": \"relative\",\n              \"display\": \"block\",\n              \"marginLeft\": \"auto\",\n              \"marginRight\": \"auto\",\n              \"maxWidth\": \"674px\"\n            }\n          }}>{`\n      `}<span parentName=\"span\" {...{\n              \"className\": \"gatsby-resp-image-background-image\",\n              \"style\": {\n                \"paddingBottom\": \"43.4375%\",\n                \"position\": \"relative\",\n                \"bottom\": \"0\",\n                \"left\": \"0\",\n                \"display\": \"block\",\n                \"transition\": \"opacity 0.5s 0.5s\",\n                \"pointerEvents\": \"none\"\n              }\n            }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n                \"srcSet\": [\"/commerce-frontend-core/static/45255649df427498ba545827ea1ca834/5530d/upgrade-framework-example-custom.webp 320w\", \"/commerce-frontend-core/static/45255649df427498ba545827ea1ca834/0c8fb/upgrade-framework-example-custom.webp 640w\", \"/commerce-frontend-core/static/45255649df427498ba545827ea1ca834/5834c/upgrade-framework-example-custom.webp 674w\"],\n                \"sizes\": \"(max-width: 674px) 100vw, 674px\",\n                \"type\": \"image/webp\"\n              }}></source>{`\n          `}<source parentName=\"picture\" {...{\n                \"srcSet\": [\"/commerce-frontend-core/static/45255649df427498ba545827ea1ca834/dd4a7/upgrade-framework-example-custom.png 320w\", \"/commerce-frontend-core/static/45255649df427498ba545827ea1ca834/0f09e/upgrade-framework-example-custom.png 640w\", \"/commerce-frontend-core/static/45255649df427498ba545827ea1ca834/84f54/upgrade-framework-example-custom.png 674w\"],\n                \"sizes\": \"(max-width: 674px) 100vw, 674px\",\n                \"type\": \"image/png\"\n              }}></source>{`\n          `}<img parentName=\"picture\" {...{\n                \"className\": \"gatsby-resp-image-image\",\n                \"src\": \"/commerce-frontend-core/static/45255649df427498ba545827ea1ca834/84f54/upgrade-framework-example-custom.png\",\n                \"alt\": \"Custom converter and upgrader classes\",\n                \"title\": \"Custom converter and upgrader classes\",\n                \"loading\": \"lazy\",\n                \"style\": {\n                  \"width\": \"100%\",\n                  \"height\": \"100%\",\n                  \"margin\": \"0\",\n                  \"verticalAlign\": \"middle\",\n                  \"position\": \"absolute\",\n                  \"opacity\": \"0\",\n                  \"transition\": \"opacity 0.5s\",\n                  \"color\": \"inherit\",\n                  \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n                  \"top\": \"0\",\n                  \"left\": \"0\"\n                }\n              }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Implement the `}<inlineCode parentName=\"p\">{`DataConverterInterface`}</inlineCode>{` to create a converter for your content type, using Page Builder's `}<inlineCode parentName=\"p\">{`FixFullWidthRowPadding`}</inlineCode>{` class as an example.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Implement the `}<inlineCode parentName=\"p\">{`DataPatchInterface`}</inlineCode>{` to create a data patch for your content type, using Page Builder's `}<inlineCode parentName=\"p\">{`UpgradeFullWidthPadding`}</inlineCode>{` class as an example.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Make a copy of the data in the `}<inlineCode parentName=\"p\">{`content`}</inlineCode>{` fields of existing entities (`}<inlineCode parentName=\"p\">{`cms_page`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`cms_block`}</inlineCode>{`, and so on). You will compare this content with the content changes made after running your upgrade patch.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Run `}<inlineCode parentName=\"p\">{`bin/magento setup:upgrade`}</inlineCode>{` to test your custom conversion.`}</p>\n        <p parentName=\"li\">{`After running `}<inlineCode parentName=\"p\">{`setup:upgrade`}</inlineCode>{`, you should see an entry at the bottom of the `}<inlineCode parentName=\"p\">{`patch_list`}</inlineCode>{` table of your Commerce database. The entry uses your module's namespace with the name of your DataPatch class. So use a descriptive name to ensure the `}<inlineCode parentName=\"p\">{`patch_list`}</inlineCode>{` entry makes sense to others.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Compare your post-upgraded content to the previous content.`}</p>\n        <p parentName=\"li\">{`If the conversion didn't convert your content as planned, remove your entry from the `}<inlineCode parentName=\"p\">{`patch_list`}</inlineCode>{` table, restore your database content to the original values, tweak your converter, then run `}<inlineCode parentName=\"p\">{`bin/magento setup:upgrade`}</inlineCode>{` again. Repeat as necessary.`}</p>\n      </li>\n    </ol>\n    <h2 {...{\n      \"id\": \"how-to-upgrade-overloaded-page-builder-content-types\"\n    }}>{`How to upgrade overloaded Page Builder content types`}</h2>\n    <p>{`If you have overloaded the configurations of native Page Builder content types, you need to review Page Builder's native configuration changes for each release. If necessary, you will need to create a converter and data patch to customize how the native content types are updated for your changes.`}</p>\n    <p>{`For example, in version 1.3, we updated the configuration of the native Row content type. As mentioned, we moved the padding attribute of the `}<inlineCode parentName=\"p\">{`full-width`}</inlineCode>{` appearance from the `}<inlineCode parentName=\"p\">{`<main>`}</inlineCode>{` element to the `}<inlineCode parentName=\"p\">{`<inner>`}</inlineCode>{` element. So if your Row configuration is different in your custom content type (for example, you removed the `}<inlineCode parentName=\"p\">{`<inner>`}</inlineCode>{` element), then you will need to upgrade your overloaded Row as described in the previous steps.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"sourceRoot":""}